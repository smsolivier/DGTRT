#include "Quadrature.hpp"

namespace trt 
{

Quadrature::Quadrature(int p, double a, double b) {
	_p = p; 
	_a = a; 
	_b = b; 

	_x.Resize(_p); 
	_w.Resize(_p); 

	switch (_p) {
		case 2: {
	_x = {
		0.5773502691896257, -0.5773502691896257, 
	};
	_w = {
		1.0, 1.0, 
	};
	break; 
}
case 3: {
	_x = {
		0.0, 0.7745966692414834, -0.7745966692414834, 
	};
	_w = {
		0.8888888888888888, 0.5555555555555556, 0.5555555555555556, 
	};
	break; 
}
case 4: {
	_x = {
		0.33998104358485626, -0.33998104358485626, 0.8611363115940526, -0.8611363115940526, 
	};
	_w = {
		0.6521451548625461, 0.6521451548625461, 0.34785484513745385, 0.34785484513745385, 
	};
	break; 
}
case 5: {
	_x = {
		0.0, 0.5384693101056831, -0.5384693101056831, 0.906179845938664, -0.906179845938664, 
	};
	_w = {
		0.5688888888888889, 0.47862867049936647, 0.47862867049936647, 0.23692688505618908, 0.23692688505618908, 
	};
	break; 
}
case 6: {
	_x = {
		0.2386191860831969, -0.2386191860831969, 0.6612093864662645, -0.6612093864662645, 0.932469514203152, -0.932469514203152, 
	};
	_w = {
		0.46791393457269104, 0.46791393457269104, 0.3607615730481386, 0.3607615730481386, 0.17132449237917036, 0.17132449237917036, 
	};
	break; 
}
case 7: {
	_x = {
		0.0, 0.4058451513773972, -0.4058451513773972, 0.7415311855993945, -0.7415311855993945, 0.9491079123427585, -0.9491079123427585, 
	};
	_w = {
		0.4179591836734694, 0.3818300505051189, 0.3818300505051189, 0.27970539148927664, 0.27970539148927664, 0.1294849661688697, 0.1294849661688697, 
	};
	break; 
}
case 8: {
	_x = {
		0.1834346424956498, -0.1834346424956498, 0.525532409916329, -0.525532409916329, 0.7966664774136267, -0.7966664774136267, 0.9602898564975363, -0.9602898564975363, 
	};
	_w = {
		0.362683783378362, 0.362683783378362, 0.31370664587788727, 0.31370664587788727, 0.22238103445337448, 0.22238103445337448, 0.10122853629037626, 0.10122853629037626, 
	};
	break; 
}
case 9: {
	_x = {
		0.0, 0.3242534234038089, -0.3242534234038089, 0.6133714327005904, -0.6133714327005904, 0.8360311073266358, -0.8360311073266358, 0.9681602395076261, -0.9681602395076261, 
	};
	_w = {
		0.3302393550012598, 0.31234707704000286, 0.31234707704000286, 0.26061069640293544, 0.26061069640293544, 0.1806481606948574, 0.1806481606948574, 0.08127438836157441, 0.08127438836157441, 
	};
	break; 
}
case 10: {
	_x = {
		0.14887433898163122, -0.14887433898163122, 0.4333953941292472, -0.4333953941292472, 0.6794095682990244, -0.6794095682990244, 0.8650633666889845, -0.8650633666889845, 0.9739065285171717, -0.9739065285171717, 
	};
	_w = {
		0.29552422471475287, 0.29552422471475287, 0.26926671930999635, 0.26926671930999635, 0.21908636251598204, 0.21908636251598204, 0.1494513491505806, 0.1494513491505806, 0.06667134430868814, 0.06667134430868814, 
	};
	break; 
}
case 11: {
	_x = {
		0.0, 0.26954315595234496, -0.26954315595234496, 0.5190961292068118, -0.5190961292068118, 0.7301520055740494, -0.7301520055740494, 0.8870625997680953, -0.8870625997680953, 0.978228658146057, -0.978228658146057, 
	};
	_w = {
		0.2729250867779006, 0.26280454451024665, 0.26280454451024665, 0.23319376459199048, 0.23319376459199048, 0.18629021092773426, 0.18629021092773426, 0.1255803694649046, 0.1255803694649046, 0.05566856711617366, 0.05566856711617366, 
	};
	break; 
}
case 12: {
	_x = {
		0.1252334085114689, -0.1252334085114689, 0.3678314989981802, -0.3678314989981802, 0.5873179542866175, -0.5873179542866175, 0.7699026741943047, -0.7699026741943047, 0.9041172563704749, -0.9041172563704749, 0.9815606342467192, -0.9815606342467192, 
	};
	_w = {
		0.24914704581340277, 0.24914704581340277, 0.2334925365383548, 0.2334925365383548, 0.20316742672306592, 0.20316742672306592, 0.16007832854334622, 0.16007832854334622, 0.10693932599531843, 0.10693932599531843, 0.04717533638651183, 0.04717533638651183, 
	};
	break; 
}
case 13: {
	_x = {
		0.0, 0.2304583159551348, -0.2304583159551348, 0.44849275103644687, -0.44849275103644687, 0.6423493394403402, -0.6423493394403402, 0.8015780907333099, -0.8015780907333099, 0.9175983992229779, -0.9175983992229779, 0.9841830547185881, -0.9841830547185881, 
	};
	_w = {
		0.2325515532308739, 0.22628318026289723, 0.22628318026289723, 0.2078160475368885, 0.2078160475368885, 0.17814598076194574, 0.17814598076194574, 0.13887351021978725, 0.13887351021978725, 0.09212149983772845, 0.09212149983772845, 0.04048400476531588, 0.04048400476531588, 
	};
	break; 
}
case 14: {
	_x = {
		0.10805494870734367, -0.10805494870734367, 0.31911236892788974, -0.31911236892788974, 0.5152486363581541, -0.5152486363581541, 0.6872929048116855, -0.6872929048116855, 0.827201315069765, -0.827201315069765, 0.9284348836635735, -0.9284348836635735, 0.9862838086968123, -0.9862838086968123, 
	};
	_w = {
		0.2152638534631578, 0.2152638534631578, 0.2051984637212956, 0.2051984637212956, 0.18553839747793782, 0.18553839747793782, 0.15720316715819355, 0.15720316715819355, 0.12151857068790319, 0.12151857068790319, 0.08015808715976021, 0.08015808715976021, 0.03511946033175186, 0.03511946033175186, 
	};
	break; 
}
case 15: {
	_x = {
		0.0, 0.20119409399743451, -0.20119409399743451, 0.3941513470775634, -0.3941513470775634, 0.5709721726085388, -0.5709721726085388, 0.7244177313601701, -0.7244177313601701, 0.8482065834104272, -0.8482065834104272, 0.937273392400706, -0.937273392400706, 0.9879925180204854, -0.9879925180204854, 
	};
	_w = {
		0.2025782419255613, 0.19843148532711158, 0.19843148532711158, 0.1861610000155622, 0.1861610000155622, 0.16626920581699392, 0.16626920581699392, 0.13957067792615432, 0.13957067792615432, 0.10715922046717194, 0.10715922046717194, 0.07036604748810812, 0.07036604748810812, 0.03075324199611727, 0.03075324199611727, 
	};
	break; 
}
case 16: {
	_x = {
		0.09501250983763744, -0.09501250983763744, 0.2816035507792589, -0.2816035507792589, 0.45801677765722737, -0.45801677765722737, 0.6178762444026438, -0.6178762444026438, 0.755404408355003, -0.755404408355003, 0.8656312023878318, -0.8656312023878318, 0.9445750230732326, -0.9445750230732326, 0.9894009349916499, -0.9894009349916499, 
	};
	_w = {
		0.1894506104550685, 0.1894506104550685, 0.18260341504492358, 0.18260341504492358, 0.16915651939500254, 0.16915651939500254, 0.14959598881657674, 0.14959598881657674, 0.12462897125553388, 0.12462897125553388, 0.09515851168249279, 0.09515851168249279, 0.062253523938647894, 0.062253523938647894, 0.027152459411754096, 0.027152459411754096, 
	};
	break; 
}
case 17: {
	_x = {
		0.0, 0.17848418149584785, -0.17848418149584785, 0.3512317634538763, -0.3512317634538763, 0.5126905370864769, -0.5126905370864769, 0.6576711592166907, -0.6576711592166907, 0.7815140038968014, -0.7815140038968014, 0.8802391537269859, -0.8802391537269859, 0.9506755217687678, -0.9506755217687678, 0.9905754753144174, -0.9905754753144174, 
	};
	_w = {
		0.17944647035620653, 0.17656270536699264, 0.17656270536699264, 0.16800410215645004, 0.16800410215645004, 0.15404576107681028, 0.15404576107681028, 0.13513636846852548, 0.13513636846852548, 0.11188384719340397, 0.11188384719340397, 0.08503614831717918, 0.08503614831717918, 0.0554595293739872, 0.0554595293739872, 0.02414830286854793, 0.02414830286854793, 
	};
	break; 
}
case 18: {
	_x = {
		0.0847750130417353, -0.0847750130417353, 0.2518862256915055, -0.2518862256915055, 0.41175116146284263, -0.41175116146284263, 0.5597708310739475, -0.5597708310739475, 0.6916870430603532, -0.6916870430603532, 0.8037049589725231, -0.8037049589725231, 0.8926024664975557, -0.8926024664975557, 0.9558239495713977, -0.9558239495713977, 0.9915651684209309, -0.9915651684209309, 
	};
	_w = {
		0.1691423829631436, 0.1691423829631436, 0.16427648374583273, 0.16427648374583273, 0.15468467512626524, 0.15468467512626524, 0.14064291467065065, 0.14064291467065065, 0.12255520671147846, 0.12255520671147846, 0.10094204410628717, 0.10094204410628717, 0.07642573025488905, 0.07642573025488905, 0.0497145488949698, 0.0497145488949698, 0.02161601352648331, 0.02161601352648331, 
	};
	break; 
}
case 19: {
	_x = {
		0.0, 0.16035864564022537, -0.16035864564022537, 0.31656409996362983, -0.31656409996362983, 0.46457074137596094, -0.46457074137596094, 0.600545304661681, -0.600545304661681, 0.7209661773352294, -0.7209661773352294, 0.8227146565371428, -0.8227146565371428, 0.9031559036148179, -0.9031559036148179, 0.96020815213483, -0.96020815213483, 0.9924068438435844, -0.9924068438435844, 
	};
	_w = {
		0.1610544498487837, 0.15896884339395434, 0.15896884339395434, 0.15276604206585967, 0.15276604206585967, 0.1426067021736066, 0.1426067021736066, 0.12875396253933621, 0.12875396253933621, 0.11156664554733399, 0.11156664554733399, 0.09149002162245, 0.09149002162245, 0.06904454273764123, 0.06904454273764123, 0.0448142267656996, 0.0448142267656996, 0.019461788229726478, 0.019461788229726478, 
	};
	break; 
}
case 20: {
	_x = {
		0.07652652113349734, -0.07652652113349734, 0.22778585114164507, -0.22778585114164507, 0.37370608871541955, -0.37370608871541955, 0.5108670019508271, -0.5108670019508271, 0.636053680726515, -0.636053680726515, 0.7463319064601508, -0.7463319064601508, 0.8391169718222188, -0.8391169718222188, 0.912234428251326, -0.912234428251326, 0.9639719272779138, -0.9639719272779138, 0.9931285991850949, -0.9931285991850949, 
	};
	_w = {
		0.15275338713072584, 0.15275338713072584, 0.14917298647260374, 0.14917298647260374, 0.14209610931838204, 0.14209610931838204, 0.13168863844917664, 0.13168863844917664, 0.11819453196151841, 0.11819453196151841, 0.10193011981724044, 0.10193011981724044, 0.08327674157670475, 0.08327674157670475, 0.06267204833410907, 0.06267204833410907, 0.04060142980038694, 0.04060142980038694, 0.017614007139152118, 0.017614007139152118, 
	};
	break; 
}
case 32: {
	_x = {
		0.04830766568773832, -0.04830766568773832, 0.1444719615827965, -0.1444719615827965, 0.23928736225213706, -0.23928736225213706, 0.33186860228212767, -0.33186860228212767, 0.42135127613063533, -0.42135127613063533, 0.5068999089322294, -0.5068999089322294, 0.5877157572407623, -0.5877157572407623, 0.6630442669302152, -0.6630442669302152, 0.7321821187402897, -0.7321821187402897, 0.7944837959679424, -0.7944837959679424, 0.84936761373257, -0.84936761373257, 0.8963211557660521, -0.8963211557660521, 0.9349060759377397, -0.9349060759377397, 0.9647622555875064, -0.9647622555875064, 0.9856115115452684, -0.9856115115452684, 0.9972638618494816, -0.9972638618494816, 
	};
	_w = {
		0.0965400885147278, 0.0965400885147278, 0.09563872007927486, 0.09563872007927486, 0.09384439908080457, 0.09384439908080457, 0.09117387869576389, 0.09117387869576389, 0.08765209300440381, 0.08765209300440381, 0.08331192422694675, 0.08331192422694675, 0.07819389578707031, 0.07819389578707031, 0.0723457941088485, 0.0723457941088485, 0.06582222277636185, 0.06582222277636185, 0.058684093478535544, 0.058684093478535544, 0.050998059262376175, 0.050998059262376175, 0.04283589802222668, 0.04283589802222668, 0.03427386291302143, 0.03427386291302143, 0.02539206530926206, 0.02539206530926206, 0.01627439473090567, 0.01627439473090567, 0.007018610009470096, 0.007018610009470096, 
	};
	break; 
}
case 64: {
	_x = {
		0.024350292663424433, -0.024350292663424433, 0.07299312178779904, -0.07299312178779904, 0.12146281929612056, -0.12146281929612056, 0.16964442042399283, -0.16964442042399283, 0.21742364374000708, -0.21742364374000708, 0.2646871622087674, -0.2646871622087674, 0.31132287199021097, -0.31132287199021097, 0.3572201583376681, -0.3572201583376681, 0.4022701579639916, -0.4022701579639916, 0.4463660172534641, -0.4463660172534641, 0.48940314570705296, -0.48940314570705296, 0.5312794640198946, -0.5312794640198946, 0.571895646202634, -0.571895646202634, 0.6111553551723933, -0.6111553551723933, 0.6489654712546573, -0.6489654712546573, 0.6852363130542333, -0.6852363130542333, 0.7198818501716109, -0.7198818501716109, 0.7528199072605319, -0.7528199072605319, 0.7839723589433414, -0.7839723589433414, 0.8132653151227975, -0.8132653151227975, 0.8406292962525803, -0.8406292962525803, 0.8659993981540928, -0.8659993981540928, 0.8893154459951141, -0.8893154459951141, 0.9105221370785028, -0.9105221370785028, 0.9295691721319396, -0.9295691721319396, 0.9464113748584028, -0.9464113748584028, 0.9610087996520538, -0.9610087996520538, 0.973326827789911, -0.973326827789911, 0.983336253884626, -0.983336253884626, 0.9910133714767443, -0.9910133714767443, 0.9963401167719553, -0.9963401167719553, 0.9993050417357722, -0.9993050417357722, 
	};
	_w = {
		0.048690957009139724, 0.048690957009139724, 0.04857546744150343, 0.04857546744150343, 0.048344762234802954, 0.048344762234802954, 0.04799938859645831, 0.04799938859645831, 0.04754016571483031, 0.04754016571483031, 0.04696818281621002, 0.04696818281621002, 0.046284796581314416, 0.046284796581314416, 0.04549162792741814, 0.04549162792741814, 0.044590558163756566, 0.044590558163756566, 0.04358372452932345, 0.04358372452932345, 0.04247351512365359, 0.04247351512365359, 0.04126256324262353, 0.04126256324262353, 0.03995374113272034, 0.03995374113272034, 0.038550153178615626, 0.038550153178615626, 0.03705512854024005, 0.03705512854024005, 0.035472213256882386, 0.035472213256882386, 0.033805161837141606, 0.033805161837141606, 0.03205792835485155, 0.03205792835485155, 0.030234657072402478, 0.030234657072402478, 0.028339672614259483, 0.028339672614259483, 0.02637746971505466, 0.02637746971505466, 0.024352702568710874, 0.024352702568710874, 0.022270173808383253, 0.022270173808383253, 0.02013482315353021, 0.02013482315353021, 0.017951715775697343, 0.017951715775697343, 0.015726030476024718, 0.015726030476024718, 0.013463047896718643, 0.013463047896718643, 0.011168139460131128, 0.011168139460131128, 0.008846759826363947, 0.008846759826363947, 0.006504457968978363, 0.006504457968978363, 0.004147033260562468, 0.004147033260562468, 0.001783280721696433, 0.001783280721696433, 
	};
	break; 
}
case 100: {
	_x = {
		0.015628984421543084, -0.015628984421543084, 0.046871682421591634, -0.046871682421591634, 0.07806858281343663, -0.07806858281343663, 0.10918920358006111, -0.10918920358006111, 0.14020313723611397, -0.14020313723611397, 0.17108008053860327, -0.17108008053860327, 0.201789864095736, -0.201789864095736, 0.23230248184497396, -0.23230248184497396, 0.2625881203715035, -0.2625881203715035, 0.292617188038472, -0.292617188038472, 0.32236034390052914, -0.32236034390052914, 0.3517885263724217, -0.3517885263724217, 0.38087298162462996, -0.38087298162462996, 0.40958529167830154, -0.40958529167830154, 0.4378974021720315, -0.4378974021720315, 0.46578164977335806, -0.46578164977335806, 0.49321078920819095, -0.49321078920819095, 0.520158019881763, -0.520158019881763, 0.5465970120650941, -0.5465970120650941, 0.5725019326213812, -0.5725019326213812, 0.5978474702471788, -0.5978474702471788, 0.6226088602037078, -0.6226088602037078, 0.6467619085141293, -0.6467619085141293, 0.670283015603141, -0.670283015603141, 0.693149199355802, -0.693149199355802, 0.7153381175730564, -0.7153381175730564, 0.7368280898020207, -0.7368280898020207, 0.7575981185197072, -0.7575981185197072, 0.7776279096494955, -0.7776279096494955, 0.7968978923903145, -0.7968978923903145, 0.8153892383391762, -0.8153892383391762, 0.8330838798884008, -0.8330838798884008, 0.8499645278795913, -0.8499645278795913, 0.8660146884971647, -0.8660146884971647, 0.8812186793850184, -0.8812186793850184, 0.895561644970727, -0.895561644970727, 0.9090295709825297, -0.9090295709825297, 0.921609298145334, -0.921609298145334, 0.9332885350430795, -0.9332885350430795, 0.944055870136256, -0.944055870136256, 0.9539007829254917, -0.9539007829254917, 0.9628136542558156, -0.9628136542558156, 0.9707857757637063, -0.9707857757637063, 0.9778093584869183, -0.9778093584869183, 0.983877540706057, -0.983877540706057, 0.9889843952429918, -0.9889843952429918, 0.9931249370374434, -0.9931249370374434, 0.9962951347331251, -0.9962951347331251, 0.9984919506395958, -0.9984919506395958, 0.9997137267734413, -0.9997137267734413, 
	};
	_w = {
		0.031255423453863354, 0.031255423453863354, 0.031224884254849358, 0.031224884254849358, 0.031163835696209907, 0.031163835696209907, 0.031072337427566515, 0.031072337427566515, 0.030950478850490987, 0.030950478850490987, 0.03079837903115259, 0.03079837903115259, 0.030616186583980447, 0.030616186583980447, 0.03040407952645482, 0.03040407952645482, 0.030162265105169145, 0.030162265105169145, 0.029890979593332832, 0.029890979593332832, 0.029590488059912642, 0.029590488059912642, 0.029261084110638276, 0.029261084110638276, 0.0289030896011252, 0.0289030896011252, 0.028516854322395098, 0.028516854322395098, 0.028102755659101173, 0.028102755659101173, 0.02766119822079239, 0.02766119822079239, 0.02719261344657688, 0.02719261344657688, 0.026697459183570964, 0.026697459183570964, 0.026176219239545676, 0.026176219239545676, 0.025629402910208116, 0.025629402910208116, 0.02505754448157959, 0.02505754448157959, 0.024461202707957052, 0.024461202707957052, 0.023840960265968207, 0.023840960265968207, 0.023197423185254123, 0.023197423185254123, 0.022531220256336273, 0.022531220256336273, 0.021843002416247388, 0.021843002416247388, 0.021133442112527642, 0.021133442112527642, 0.020403232646209433, 0.020403232646209433, 0.019653087494435305, 0.019653087494435305, 0.018883739613374903, 0.018883739613374903, 0.018095940722128116, 0.018095940722128116, 0.017290460568323583, 0.017290460568323583, 0.016468086176145213, 0.016468086176145213, 0.015629621077546004, 0.015629621077546004, 0.014775884527441302, 0.014775884527441302, 0.013907710703718773, 0.013907710703718773, 0.013025947892971542, 0.013025947892971542, 0.012131457662979498, 0.012131457662979498, 0.011225114023185977, 0.011225114023185977, 0.01030780257486897, 0.01030780257486897, 0.009380419653694457, 0.009380419653694457, 0.00844387146966897, 0.00844387146966897, 0.007499073255464711, 0.007499073255464711, 0.006546948450845322, 0.006546948450845322, 0.005588428003865515, 0.005588428003865515, 0.0046244500634221196, 0.0046244500634221196, 0.0036559612013263754, 0.0036559612013263754, 0.0026839253715534826, 0.0026839253715534826, 0.0017093926535181052, 0.0017093926535181052, 0.0007346344905056717, 0.0007346344905056717, 
	};
	break; 
}


		default: {
			ERROR("integration of order" << _p << " not defined"); 
		} 
	}

	CHECK(_x.Size() == _w.Size(), "initialization error"); 

	double diff = (b - a)/2; 
	double avg = (a+b)/2; 
	for (int i=0; i<_x.Size(); i++) {
		_x[i] = diff*_x[i] + avg; 
		_w[i] *= diff; 
	}
}

} // end namespace trt 